# Generated by Django 5.1.4 on 2026-01-15 14:44

import django.core.validators
import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='MSMEApplication',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('application_number', models.CharField(max_length=50, unique=True)),
                ('company_name', models.CharField(max_length=200)),
                ('msme_category', models.CharField(choices=[('micro', 'Micro'), ('small', 'Small'), ('medium', 'Medium')], max_length=20)),
                ('final_credit_score', models.IntegerField(blank=True, null=True)),
                ('risk_tier', models.CharField(blank=True, choices=[('prime', 'Prime'), ('near_prime', 'Near Prime'), ('standard', 'Standard'), ('subprime', 'Subprime'), ('high_risk', 'High Risk')], max_length=20, null=True)),
                ('overdraft_limit', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('in_review', 'In Review'), ('approved', 'Approved'), ('rejected', 'Rejected'), ('more_info_required', 'More Info Required')], default='pending', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='msme_applications', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'MSME Application',
                'verbose_name_plural': 'MSME Applications',
                'db_table': 'msme_applications',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='MSMEAnalysisResult',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('all_features', models.JSONField(default=dict, help_text='All extracted features')),
                ('director_score', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('business_identity_score', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('revenue_score', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('cashflow_score', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('credit_score', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('compliance_score', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('fraud_score', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('external_score', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('vendor_score', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('final_credit_score', models.IntegerField(blank=True, null=True)),
                ('default_probability', models.DecimalField(blank=True, decimal_places=4, max_digits=5, null=True)),
                ('risk_tier', models.CharField(blank=True, max_length=20, null=True)),
                ('overdraft_limit', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('recommended_interest_rate', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('shap_values', models.JSONField(default=dict, help_text='SHAP explanation values')),
                ('feature_importance', models.JSONField(default=dict)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('application', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='analysis_result', to='msme.msmeapplication')),
            ],
            options={
                'verbose_name': 'MSME Analysis Result',
                'verbose_name_plural': 'MSME Analysis Results',
                'db_table': 'msme_analysis_results',
            },
        ),
        migrations.CreateModel(
            name='FraudVerification',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('kyc_completion_score', models.DecimalField(decimal_places=2, default=0, max_digits=5, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(1)])),
                ('shop_image_verified', models.BooleanField(default=False)),
                ('shop_verification_data', models.JSONField(default=dict, help_text='Photo + geolocation data')),
                ('circular_transaction_detected', models.BooleanField(default=False, help_text='First 7 vs last 7 days check')),
                ('font_variation_detected', models.BooleanField(default=False, help_text='Bank statement font check')),
                ('bank_statement_ocr_verified', models.BooleanField(default=False)),
                ('overall_fraud_risk', models.CharField(choices=[('low', 'Low'), ('medium', 'Medium'), ('high', 'High')], default='low', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('application', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='fraud_verification', to='msme.msmeapplication')),
            ],
            options={
                'verbose_name': 'Fraud & Verification',
                'verbose_name_plural': 'Fraud & Verification',
                'db_table': 'msme_fraud_verification',
            },
        ),
        migrations.CreateModel(
            name='ExternalSignals',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('online_reviews_count', models.IntegerField(default=0)),
                ('online_reviews_avg_rating', models.DecimalField(decimal_places=2, default=0, max_digits=3, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(5)])),
                ('review_sentiment', models.CharField(choices=[('positive', 'Positive'), ('neutral', 'Neutral'), ('negative', 'Negative')], default='neutral', max_length=20)),
                ('review_sentiment_score', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('application', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='external_signals', to='msme.msmeapplication')),
            ],
            options={
                'verbose_name': 'External Signals',
                'verbose_name_plural': 'External Signals',
                'db_table': 'msme_external_signals',
            },
        ),
        migrations.CreateModel(
            name='DirectorProfile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=200)),
                ('age', models.IntegerField(validators=[django.core.validators.MinValueValidator(18), django.core.validators.MaxValueValidator(100)])),
                ('address', models.TextField()),
                ('pan', models.CharField(max_length=10)),
                ('phone_number', models.CharField(max_length=15)),
                ('avg_account_balance_personal', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('assets_derived', models.JSONField(default=dict, help_text='Assets breakdown')),
                ('liabilities_derived', models.JSONField(default=dict, help_text='Liabilities breakdown')),
                ('regular_p2p_transactions', models.BooleanField(default=False)),
                ('monthly_income', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('monthly_inflow', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('monthly_outflow', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('income_volatility', models.DecimalField(decimal_places=2, default=0, help_text='Coefficient of variation', max_digits=5)),
                ('subscriptions', models.JSONField(default=list, help_text='List of recurring subscriptions')),
                ('micro_commitments', models.JSONField(default=list, help_text='Display only - NOT for scoring')),
                ('late_night_transactions_count', models.IntegerField(default=0, help_text='Emotional indicator')),
                ('savings_consistency_score', models.DecimalField(decimal_places=2, default=0, max_digits=5, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(1)])),
                ('is_stable', models.BooleanField(default=True, help_text='Stable if income change < 30%')),
                ('income_change_percentage', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('application', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='directors', to='msme.msmeapplication')),
            ],
            options={
                'verbose_name': 'Director Profile',
                'verbose_name_plural': 'Director Profiles',
                'db_table': 'msme_director_profiles',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='CreditRepayment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('on_time_repayment_ratio', models.DecimalField(decimal_places=2, default=0, max_digits=5, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(1)])),
                ('last_6_months_payment_history', models.JSONField(default=list, help_text='Monthly payment status')),
                ('bounced_cheques_count', models.IntegerField(default=0, validators=[django.core.validators.MinValueValidator(0)])),
                ('current_debt', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('total_debt_status', models.CharField(choices=[('low', 'Low'), ('moderate', 'Moderate'), ('high', 'High')], default='low', max_length=20)),
                ('historical_loan_utilization', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('rent_payment_regularity', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('supplier_payment_regularity', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('utility_payment_on_time_ratio', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('application', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='credit_repayment', to='msme.msmeapplication')),
            ],
            options={
                'verbose_name': 'Credit & Repayment',
                'verbose_name_plural': 'Credit & Repayment',
                'db_table': 'msme_credit_repayment',
            },
        ),
        migrations.CreateModel(
            name='ComplianceTaxation',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('gst_filing_regularity', models.DecimalField(decimal_places=2, default=0, help_text='Percentage of on-time GST filings', max_digits=5)),
                ('itr_filed', models.BooleanField(default=False, help_text='Income Tax Return filed')),
                ('gst_filing_on_time_ratio', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('gst_platform_sales_mismatch', models.DecimalField(decimal_places=2, default=0, help_text='Percentage mismatch', max_digits=5)),
                ('gst_r1_itr_mismatch', models.DecimalField(decimal_places=2, default=0, help_text='Percentage mismatch between GST R1 and ITR', max_digits=5)),
                ('tax_payment_regularity', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('refund_chargeback_rate', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('application', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='compliance_taxation', to='msme.msmeapplication')),
            ],
            options={
                'verbose_name': 'Compliance & Taxation',
                'verbose_name_plural': 'Compliance & Taxation',
                'db_table': 'msme_compliance_taxation',
            },
        ),
        migrations.CreateModel(
            name='CashFlowBanking',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('average_bank_balance', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('balance_trend', models.CharField(choices=[('increasing', 'Increasing'), ('stable', 'Stable'), ('decreasing', 'Decreasing')], default='stable', max_length=20)),
                ('negative_balance_days', models.IntegerField(default=0)),
                ('avg_daily_closing_balance', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('daily_min_balance_pattern', models.JSONField(default=dict, help_text='Daily minimum balance patterns')),
                ('inflow_amount', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('outflow_amount', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('inflow_outflow_ratio', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('deposit_consistency_score', models.DecimalField(decimal_places=2, default=0, help_text='Display only - NOT for scoring', max_digits=5)),
                ('deposit_trend_data', models.JSONField(default=dict, help_text='Deposit patterns over time')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('application', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='cashflow_banking', to='msme.msmeapplication')),
            ],
            options={
                'verbose_name': 'Cash Flow & Banking',
                'verbose_name_plural': 'Cash Flow & Banking',
                'db_table': 'msme_cashflow_banking',
            },
        ),
        migrations.CreateModel(
            name='BusinessIdentity',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('company_name', models.CharField(max_length=200)),
                ('industry', models.CharField(max_length=100)),
                ('business_vintage_years', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('legal_entity_type', models.CharField(choices=[('proprietorship', 'Proprietorship'), ('partnership', 'Partnership'), ('llp', 'Limited Liability Partnership'), ('private_limited', 'Private Limited'), ('public_limited', 'Public Limited'), ('trust', 'Trust'), ('society', 'Society'), ('unregistered', 'Unregistered')], max_length=50)),
                ('msme_category', models.CharField(choices=[('micro', 'Micro'), ('small', 'Small'), ('medium', 'Medium')], max_length=20)),
                ('gstin', models.CharField(blank=True, max_length=15)),
                ('pan', models.CharField(max_length=10)),
                ('gst_locations', models.JSONField(default=list, help_text='GST-based locations')),
                ('business_structure', models.CharField(blank=True, max_length=100)),
                ('verification_status', models.CharField(choices=[('verified', 'Verified'), ('pending', 'Pending'), ('failed', 'Failed')], default='pending', max_length=20)),
                ('licenses_certificates', models.JSONField(default=list, help_text='Verified licenses and certificates')),
                ('employees_count', models.IntegerField(default=0, validators=[django.core.validators.MinValueValidator(0)])),
                ('locations', models.JSONField(default=list, help_text='Business locations')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('application', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='business_identity', to='msme.msmeapplication')),
            ],
            options={
                'verbose_name': 'Business Identity',
                'verbose_name_plural': 'Business Identities',
                'db_table': 'msme_business_identity',
            },
        ),
        migrations.CreateModel(
            name='MSMEDocumentUpload',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('document_type', models.CharField(choices=[('bank_statement', 'Bank Statement'), ('gst_return', 'GST Return'), ('itr', 'Income Tax Return'), ('shop_image', 'Shop Image'), ('license', 'License/Certificate'), ('other', 'Other')], max_length=50)),
                ('file', models.FileField(upload_to='msme_documents/%Y/%m/%d/')),
                ('file_name', models.CharField(max_length=255)),
                ('file_size', models.IntegerField(default=0, help_text='Size in bytes')),
                ('uploaded_at', models.DateTimeField(auto_now_add=True)),
                ('processed', models.BooleanField(default=False)),
                ('processed_at', models.DateTimeField(blank=True, null=True)),
                ('application', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='documents', to='msme.msmeapplication')),
            ],
            options={
                'verbose_name': 'MSME Document Upload',
                'verbose_name_plural': 'MSME Document Uploads',
                'db_table': 'msme_document_uploads',
                'ordering': ['-uploaded_at'],
            },
        ),
        migrations.CreateModel(
            name='RevenuePerformance',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('weekly_gtv', models.DecimalField(decimal_places=2, default=0, help_text='Gross Transaction Value', max_digits=15)),
                ('monthly_gtv', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('mom_growth', models.DecimalField(decimal_places=2, default=0, help_text='Month-over-Month Growth %', max_digits=5)),
                ('qoq_growth', models.DecimalField(decimal_places=2, default=0, help_text='Quarter-over-Quarter Growth %', max_digits=5)),
                ('gross_profit_margin', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('net_profit_margin', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('profit_margin_roinet', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('weekly_cash_in_hand', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('monthly_cash_in_hand', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('daily_transactions_count', models.IntegerField(default=0)),
                ('average_transaction_value', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('revenue_concentration_data', models.JSONField(default=dict, help_text='Monthly revenue distribution')),
                ('peak_day_dependency_data', models.JSONField(default=dict, help_text='Daily revenue peak analysis')),
                ('operational_leverage', models.DecimalField(decimal_places=2, default=0, help_text='Fixed Cost / Total Cost', max_digits=5)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('application', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='revenue_performance', to='msme.msmeapplication')),
            ],
            options={
                'verbose_name': 'Revenue Performance',
                'verbose_name_plural': 'Revenue Performances',
                'db_table': 'msme_revenue_performance',
            },
        ),
        migrations.CreateModel(
            name='VendorPayments',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('vendor_payment_consistency', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('verified_vendors_count', models.IntegerField(default=0)),
                ('total_vendors_count', models.IntegerField(default=0)),
                ('vendor_verification_rate', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('long_term_vendors_count', models.IntegerField(default=0, help_text='Vendors > 12 months')),
                ('long_term_vendors_data', models.JSONField(default=list)),
                ('avg_vendor_transaction_value', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('vendor_concentration_ratio', models.DecimalField(decimal_places=2, default=0, help_text='Top vendor dependency', max_digits=5)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('application', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='vendor_payments', to='msme.msmeapplication')),
            ],
            options={
                'verbose_name': 'Vendor Payments',
                'verbose_name_plural': 'Vendor Payments',
                'db_table': 'msme_vendor_payments',
            },
        ),
    ]
